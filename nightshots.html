<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Astro/Night (35mm Film) - One Plus One Creatives</title>
    <link rel="stylesheet" href="styles.css">
    <script src="night-photos.js"></script>
</head>
<body>
    <button class="font-toggle" onclick="toggleFont()" id="fontToggle">Dyslexic Friendly Font Here!</button>
    
    <div class="container">
        <h1>One Plus One Creatives</h1>
        <div class="tagline">Let's do things our future selves will thank us for</div>
        
        <!-- Navigation with links -->
        <div class="nav">
            <a href="index.html">Home</a>
            <a href="general-shots.html">General Shots (35mm Film)</a>
            <span class="active">Astro/Night (35mm Film)</span>
            <span>Digital</span>
            <a href="tinkering.html">Tinkering/Restorations</a>
            <a href="musings.html">Musings</a>
            <a href="makersshowcase.html">Makers Showcase</a>
        </div>
        
        <button class="random-photo-btn" onclick="openRandomPhoto()">ðŸŽ² Random Photo</button>
        
        <div class="content-box">
            <h2>Astro/Night (35mm Film)</h2>
            <p>For some of these shots, I used my StarAdventure 2i which keeps the camera moving with the stars. Unless stated on the picture itself, these were taken with my Canon Rebel 2000 using the Canon EF 28-70mm II.</p>
            
            <!-- View Toggle -->
            <div class="view-toggle">
                <button class="view-btn active" onclick="setViewMode('paginated', this)">Paginated View</button>
                <button class="view-btn" onclick="setViewMode('all', this)">Load All Photos</button>
            </div>
            
            <!-- Pagination Controls (shown only in paginated mode) -->
            <div class="pagination-controls" id="paginationControls">
                <button class="pagination-btn" onclick="goToFirstPage()">Â« First</button>
                <button class="pagination-btn" onclick="previousPage()">â€¹ Previous</button>
                <span class="page-info" id="pageInfo">Page 1 of 1</span>
                <button class="pagination-btn" onclick="nextPage()">Next â€º</button>
                <button class="pagination-btn" onclick="goToLastPage()">Last Â»</button>
                <select class="photos-per-page" id="photosPerPage" onchange="changePhotosPerPage()">
                    <option value="12">12 per page</option>
                    <option value="16" selected>16 per page</option>
                    <option value="24">24 per page</option>
                    <option value="32">32 per page</option>
                </select>
            </div>
            
            <!-- Photo grid -->
            <div class="photo-grid" id="gallery"></div>
            
            <!-- Bottom Pagination (duplicate for convenience) -->
            <div class="pagination-controls" id="bottomPaginationControls">
                <button class="pagination-btn" onclick="goToFirstPage()">Â« First</button>
                <button class="pagination-btn" onclick="previousPage()">â€¹ Previous</button>
                <span class="page-info" id="bottomPageInfo">Page 1 of 1</span>
                <button class="pagination-btn" onclick="nextPage()">Next â€º</button>
                <button class="pagination-btn" onclick="goToLastPage()">Last Â»</button>
            </div>
        </div>
        
        <div class="copyright">
            Â© 2025 One Plus One Creatives. All Rights Reserved.
        </div>
        
        <div class="contact">
            <a href="mailto:contact@oneplusonecreatives.com">Contact Me</a>
        </div>
    </div>
    
    <!-- Lightbox container -->
    <div id="lightbox" class="lightbox">
        <span class="close-lightbox" onclick="closeLightbox()">&times;</span>
        <div class="keyboard-hint">Press the 'i' for a caption if it has one, or do the same with your keyboard!</div>
        <div class="lightbox-nav prev-btn" onclick="prevImage()">&lsaquo;</div>
        <img id="lightbox-img" src="">
        <div class="lightbox-nav next-btn" onclick="nextImage()">&rsaquo;</div>
        <div class="image-caption" id="image-caption"></div>
        <div class="image-counter" id="image-counter">1 / 51</div>
        <div class="info-btn" id="info-btn" onclick="toggleCaption()">â“˜</div>
    </div>
    
    <script>
        // Photo data loaded from external file
        const photoData = nightPhotosData;

        // Pagination variables
        let currentPage = 1;
        let photosPerPage = 16;
        let viewMode = 'paginated';
        let allImages = [];
        let allCaptions = [];
        let currentImageIndex = 0;

        // Initialize the gallery when page loads
        window.addEventListener('DOMContentLoaded', function() {
            initializeGallery();
            
            // Add touch event listener for mobile captions
            document.addEventListener('touchstart', function(e) {
                if (e.target.closest('.photo-item') && e.target.tagName !== 'IMG') {
                    const photoItem = e.target.closest('.photo-item');
                    photoItem.classList.toggle('caption-visible');
                }
            });
        });

        // Initialize the gallery
        function initializeGallery() {
            if (viewMode === 'paginated') {
                loadPage(currentPage);
            } else {
                loadAllPhotos();
            }
            updatePaginationControls();
        }

        // Set view mode (paginated or all)
        function setViewMode(mode, button) {
            viewMode = mode;
            currentPage = 1;
            
            // Update button states
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
            
            // Show/hide pagination controls
            const paginationControls = document.querySelectorAll('.pagination-controls');
            if (mode === 'paginated') {
                paginationControls.forEach(control => control.style.display = 'flex');
                loadPage(currentPage);
            } else {
                paginationControls.forEach(control => control.style.display = 'none');
                loadAllPhotos();
            }
        }

        // Load a specific page
        function loadPage(page) {
            const gallery = document.getElementById('gallery');
            gallery.innerHTML = '';
            
            const startIndex = (page - 1) * photosPerPage;
            const endIndex = Math.min(startIndex + photosPerPage, photoData.length);
            
            for (let i = startIndex; i < endIndex; i++) {
                createPhotoItem(photoData[i], i);
            }
            
            updatePaginationControls();
            updateGlobalImageArrays();
            
            // Scroll to top of gallery
            gallery.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // Load all photos at once
        function loadAllPhotos() {
            const gallery = document.getElementById('gallery');
            gallery.innerHTML = '';
            
            photoData.forEach((photo, index) => {
                createPhotoItem(photo, index);
            });
            
            updateGlobalImageArrays();
        }

        // Create a photo item with lazy loading
        function createPhotoItem(photo, index) {
            const gallery = document.getElementById('gallery');
            const photoItem = document.createElement('div');
            photoItem.className = 'photo-item loading';
            
            const img = document.createElement('img');
            img.alt = photo.alt;
            img.setAttribute('data-src', photo.thumb);
            img.setAttribute('onclick', `openLightbox('${photo.full}', ${index})`);
            
            if (photo.caption) {
                const captionDiv = document.createElement('div');
                captionDiv.className = 'gallery-caption';
                captionDiv.innerHTML = photo.caption;
                photoItem.appendChild(captionDiv);
            }
            
            photoItem.appendChild(img);
            gallery.appendChild(photoItem);
            
            // Lazy load the image
            lazyLoadImage(img, photoItem);
        }

        // Lazy load an image
        function lazyLoadImage(img, container) {
            const imageLoader = new Image();
            imageLoader.onload = function() {
                img.src = this.src;
                container.classList.remove('loading');
                container.classList.add('loaded');
            };
            imageLoader.src = img.getAttribute('data-src');
        }

        // Update pagination controls
        function updatePaginationControls() {
            const totalPages = Math.ceil(photoData.length / photosPerPage);
            
            // Update page info
            document.getElementById('pageInfo').textContent = `Page ${currentPage} of ${totalPages}`;
            document.getElementById('bottomPageInfo').textContent = `Page ${currentPage} of ${totalPages}`;
            
            // Update button states
            const prevButtons = document.querySelectorAll('.pagination-btn');
            prevButtons.forEach(btn => {
                if (btn.textContent.includes('First') || btn.textContent.includes('Previous')) {
                    btn.disabled = currentPage === 1;
                }
                if (btn.textContent.includes('Last') || btn.textContent.includes('Next')) {
                    btn.disabled = currentPage === totalPages;
                }
            });
        }

        // Navigation functions
        function goToFirstPage() {
            currentPage = 1;
            loadPage(currentPage);
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                loadPage(currentPage);
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(photoData.length / photosPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                loadPage(currentPage);
            }
        }

        function goToLastPage() {
            currentPage = Math.ceil(photoData.length / photosPerPage);
            loadPage(currentPage);
        }

        function changePhotosPerPage() {
            photosPerPage = parseInt(document.getElementById('photosPerPage').value);
            currentPage = 1;
            loadPage(currentPage);
        }

        // Update global image arrays for lightbox
        function updateGlobalImageArrays() {
            allImages = photoData.map(photo => photo.full);
            allCaptions = photoData.map(photo => photo.caption || '');
        }

        // Lightbox functions
        function openLightbox(imageSrc, index) {
            currentImageIndex = index;
            document.getElementById('lightbox-img').src = imageSrc;
            document.getElementById('lightbox').style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            updateLightboxInfo();
            document.addEventListener('keydown', handleKeyPress);
        }

        function closeLightbox() {
            document.getElementById('lightbox').style.display = 'none';
            document.body.style.overflow = 'auto';
            document.removeEventListener('keydown', handleKeyPress);
            
            const caption = document.getElementById('image-caption');
            const infoBtn = document.getElementById('info-btn');
            caption.classList.remove('visible');
            infoBtn.classList.remove('active');
        }

        function prevImage() {
            currentImageIndex = (currentImageIndex - 1 + allImages.length) % allImages.length;
            document.getElementById('lightbox-img').src = allImages[currentImageIndex];
            updateLightboxInfo();
        }

        function nextImage() {
            currentImageIndex = (currentImageIndex + 1) % allImages.length;
            document.getElementById('lightbox-img').src = allImages[currentImageIndex];
            updateLightboxInfo();
        }

        function updateLightboxInfo() {
            document.getElementById('image-counter').textContent = `${currentImageIndex + 1} / ${allImages.length}`;
            
            const captionElement = document.getElementById('image-caption');
            if (allCaptions[currentImageIndex]) {
                captionElement.innerHTML = allCaptions[currentImageIndex];
            } else {
                captionElement.innerHTML = '';
            }
            
            captionElement.classList.remove('visible');
            document.getElementById('info-btn').classList.remove('active');
        }

        function toggleCaption() {
            const caption = document.getElementById('image-caption');
            const infoBtn = document.getElementById('info-btn');
            
            if (caption.classList.contains('visible')) {
                caption.classList.remove('visible');
                infoBtn.classList.remove('active');
            } else {
                if (allCaptions[currentImageIndex]) {
                    caption.classList.add('visible');
                    infoBtn.classList.add('active');
                }
            }
        }

        function handleKeyPress(e) {
            switch(e.key) {
                case 'ArrowLeft':
                    prevImage();
                    break;
                case 'ArrowRight':
                    nextImage();
                    break;
                case 'Escape':
                    closeLightbox();
                    break;
                case 'i':
                case 'I':
                    toggleCaption();
                    break;
            }
        }

        // Open a random photo
        function openRandomPhoto() {
            if (allImages.length === 0) {
                updateGlobalImageArrays();
            }
            
            const randomIndex = Math.floor(Math.random() * allImages.length);
            openLightbox(allImages[randomIndex], randomIndex);
        }

        // Font toggle functionality
        function toggleFont() {
            document.body.classList.toggle('dyslexic-font');
            const button = document.getElementById('fontToggle');
            if (document.body.classList.contains('dyslexic-font')) {
                button.textContent = 'Switch to Standard Font';
            } else {
                button.textContent = 'Dyslexic Friendly Font Here!';
            }
        }

        // Close lightbox when clicking outside the image
        document.getElementById('lightbox').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLightbox();
            }
        });
    </script>
</body>
</html>